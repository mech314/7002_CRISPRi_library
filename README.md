# Illumina Sequence Analysis Pipeline

This pipeline processes Illumina sequence data to:
- Trim sequences at 95% accuracy.
- Perform global alignment.
- Extract read counts.
- Run differential expression analysis using **DESeq2** in R.
- Combine all log-fold change (LFC) data into one comprehensive dataframe for downstream analysis.

---

## **Requirements**

The pipeline is written in Python and R, and requires the following dependencies:

### **Python Dependencies**
- `re`
- `tqdm`
- `polars`
- `pathlib`
- `argparse`

#### Install these Python packages via pip:
```bash
pip install tqdm polars argoparse pathlib
```

### **R Packages**
- `DESeq2`

#### Installing R Packages
Install DESeq2 in R:
```R
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("DESeq2")
```

## Example Workflow
Here is a high-level description of the workflow:
1. Combine reads from Illumina sequencing files using 'merge_paris.sh'
2. Perform global alignment, adjust number of cores and identity % using 'global_aligment.sh'.
3. Extract read counts from aligned reads using 'ExtCounts.py' and 'count_combiner.py'.
4. Run DESeq2 for differential expression analysis using 'run_DESeq1.R'.
5. Consolidate all log fold change (LFC) results into one dataframe using 'LFC_combiner.py'.

## Example Table
Below is an example of the output table generated by the pipeline:

```
| Gene_ID   | Condition_A_LFC | Condition_B_LFC | Condition_C_LFC | locus          |
|-----------|-----------------|-----------------|-----------------|-----------------|
| Gene_1    | -1.23           | 0.45            | 2.34            | A0001           |    
| Gene_2    | 0.56            | -0.78           | 1.12            | A0002           |
| Gene_3    | 1.34            | -1.45           | 0.89            | A0003           |
```

The table contains:
- **Gene_ID**: The identifier for each gene.
- **Condition_X_LFC**: Log fold change values for different conditions.
- **locus**: Gene locus

## Notes
- Ensure that input reads are pre-processed and meet the quality standards required for alignment.
- Customize alignment parameters in the script as needed for specific datasets eg organism name, locus name and lenght etc.
- The output files will include intermediate data, alignment results, and the final LFC dataframe.

## Contributing
Contributions are welcome! Please open an issue or submit a pull request if you would like to add features or improve the pipeline.
